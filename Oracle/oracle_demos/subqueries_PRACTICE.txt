SELECT ename,deptno FROM emp
 WHERE deptno IN
  (SELECT deptno FROM emp GROUP BY deptno
	 HAVING AVG(sal)>2500);

SELECT ename,deptno FROM emp
 WHERE deptno NOT IN
  (SELECT deptno FROM emp GROUP BY deptno
	 HAVING AVG(sal)>250);

SELECT ename,deptno FROM emp WHERE sal>ANY
  	(SELECT avg(sal) FROM emp);


SELECT ename,deptno FROM emp WHERE sal>ANY
   	(SELECT avg(sal) FROM emp group by job);

SELECT ename,deptno FROM emp WHERE sal>ALL
    	(SELECT avg(sal) FROM emp group by job);

SELECT STAFF_CODE,STAFF_NAME,DEPT_CODE,STAFF_SAL 
FROM STAFF_MASTERS S WHERE STAFF_SAL>
	(SELECT AVG(STAFF_SAL) FROM STAFF_MASTERS M
		WHERE S.DEPT_CODE = M.DEPT_CODE);

SELECT STAFF_CODE,STAFF_NAME 
FROM STAFF_MASTERS S WHERE EXISTS
	(SELECT MGR_CODE FROM STAFF_MASTERS M
		WHERE S.MGR_CODE = M.MGR_CODE);



SELECT STAFF_CODE,STAFF_NAME 
FROM STAFF_MASTERS S WHERE NOT EXISTS
	(SELECT MGR_CODE FROM STAFF_MASTERS M
		WHERE S.MGR_CODE = M.MGR_CODE);



SELECT DEPT_CODE,DEPT_NAME 
FROM DEPARTMENT_MASTERS D WHERE NOT EXISTS
	(SELECT DEPT_CODE FROM STAFF_MASTERS S
		WHERE S.DEPT_CODE = D.DEPT_CODE);




SELECT DEPT_CODE,DEPT_NAME 
FROM DEPARTMENT_MASTERS D WHERE EXISTS
	(SELECT DEPT_CODE FROM STAFF_MASTERS S
		WHERE S.DEPT_CODE = D.DEPT_CODE);

SELECT STAFF_CODE,STAFF_NAME ,MGR_CODE
FROM STAFF_MASTERS 
CONNECT BY PRIOR STAFF_CODE = MGR_CODE
START WITH UPPER(STAFF_NAME)='ALLEN';

SELECT ename FROM emp
 CONNECT BY prior empno=mgr 
START WITH lower(ename)='blake';
